package park;


import elements.Car;
import elements.LinkedList;
import elements.Stack;
import io.Out;

public class park {
	Stack<Car> place = new Stack<Car>();
	LinkedList<Car> road = new LinkedList<Car>();
	Out output = new Out();
	 int s_max = 3;
	 int s_count = 0;
	 int count = 0;
	public int smax() {
		return s_max;
	}
	public int scount() {
		return s_count;
	}
	public int count() {
		return count;
	}

	void change_smax(int a) {
		this.s_max = a;
	}

	int size() {
		return count;
	}


	void in(String str) {
		Car tmp = new Car(str);
		if (s_count < s_max) {
			tmp.info();
			place.add(tmp);
			s_count++;
			count++;
			output.output(place.peek().tostring());
		} else {
			road.add(tmp);
			count++;
			output.output(road.get(count - s_count - 1).tostring());
		}

	}

	@SuppressWarnings("unused")
	public String out(String str) {
		String infomation = "提车成功";
		if(count!=0) {
			for(int i=0;i<count - s_count;i++) {
				if(road.get(i).number.equals(str))
					road.remove(i);
				return infomation;
			}
			Stack<Car>tmp=new Stack<Car>();
			for(int j=0;j<s_count;j++) {
				if(place.get(j).number.equals(str)) {
					place.pop();
					s_count--;
					count--;
				}
				else {
					tmp.push(place.pop());
					s_count--;
				}
			}
			while(!tmp.isEmpty()) {
				place.push(tmp.pop());
				s_count++;
			}
			if(s_count==s_max) return infomation="未找到该车辆";
			else if(count>s_max&&s_count<s_max) {
				Car item=road.remove();
				item.info();
				item.time();
				place.push(item);
				s_count++;
				count++;
			}
		}else {
			infomation="车位中未停放车辆";
		}
		return infomation;
	}
	public Car search(String str) {
		if (count!=0) {
			for(int i=0;i<count-s_count;i++)
				if(road.get(i).number.equals(str))
					return road.get(i);
			for(int j =0;j<s_count;j++)
				if(place.get(j).number.equals(str))
					return place.get(j);
			return null;
		}
		return null;
	}
	public Object[][] show() {
			Object[][] s = new Object[count][3];
			long endtime = System.currentTimeMillis();
			for (int i = 0; i < s_count; i++) {
				s[i][0] = place.get(i).number;
				s[i][1] = place.get(i).info;
				s[i][2] = (endtime-place.get(i).time)/(1000*60);
			}
			return s;
	}
}
